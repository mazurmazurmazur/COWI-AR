/*!
 *  geolocation-simulator.js v0.0.1
 *  (c) 2014, Russell Goldenberg
 *  MIT License
 */
(function() {
  var e = 110.562,
    t = 3600,
    n = 1e3;
  var r = function(r) {
    function d() {
      l++;
      if (l < o.length - 1) {
        var t = o[l];
        a.coords.latitude = t.latitude;
        a.coords.longitude = t.longitude;
        var r = (o[l + 1].latitude - t.latitude) * e,
          i = (o[l + 1].longitude - t.longitude) * e;
        var s = Math.sqrt(r * r + i * i);
        var d = Math.floor(s / u);
        f.latitude = r / d / e;
        f.longitude = i / d / e;
        h = d;
        p = 0;
        if (t.pause) {
          console.log(
            "(stops to smell the roses* for",
            Math.floor(t.pause / 1e3),
            "seconds)"
          );
          c = setTimeout(v, t.pause);
        } else {
          setTimeout(v, n);
        }
      } else {
        alert("you have arrived!");
      }
    }
    function v() {
      p++;
      if (p < h) {
        a.coords.latitude += f.latitude;
        a.coords.longitude += f.longitude;
        setTimeout(v, n);
      } else {
        d();
      }
    }
    var i = {};
    var s = null,
      o = r.coords,
      u = (r.speed || 40) / t,
      a = {
        coords: {
          latitude: 0,
          longitude: 0,
          accuracy: 1,
          altitude: null,
          altitudeAccuracy: null,
          heading: null,
          speed: null
        },
        timestamp: 1
      },
      f = { latitude: 0, longitude: 0 },
      l = -1,
      c,
      h,
      p;
    i.start = function() {
      d();
    };
    navigator.geolocation.getCurrentPosition = function(e, t, n) {
      e(a);
    };
    navigator.geolocation.watchPosition = function(e, t, n) {
      var r = function() {
        e(a);
        s = setTimeout(r, 1e3);
      };
      r();
    };
    navigator.geolocation.clearWatch = function() {
      clearTimeout(s);
    };
    return i;
  };
  if (typeof Number.prototype.toRad === "undefined") {
    Number.prototype.toRad = function() {
      return (this * Math.PI) / 180;
    };
  }
  window.GeolocationSimulator = r;
})();
